<!DOCTYPE html>
<html lang="zh-cmn-Hans">










<head>
  <title>如何讓chrome支持ESNI - 技术 - 2049BBS</title>

  <meta http-equiv="Content-Type" content="text/html;charset=utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0">

  <link rel="shortcut icon" href=".././static/favicon.ico" type="image/x-icon">

  <link rel="canonical" href="https://2049bbs.github.io" />

  <link href=".././feed.xml" rel="alternate" title="2049BBS - ATOM Feed" type="application/atom+xml">

  <link rel="stylesheet" href=".././static/default/style.css">
  <link rel="stylesheet" href=".././static/css/jquery.toast.css">
  <link rel="stylesheet" href=".././static/css/uploadifive.css">
  <link rel="stylesheet" href=".././static/highligt/sunburst.min.css">

  <script src=".././static/js/jquery.min.js"></script>
  <script src=".././static/js/jquery.toast.js"></script>
  <script src=".././static/js/md5.min.js"></script>
  <script src=".././static/js/jquery.uploadifive.min.js"></script>
  <script src=".././static/highligt/highlight.pack.js"></script>

  <script>hljs.initHighlightingOnLoad();</script>
  <script>
    $(function () {
      $("#go-to-top").click(function () {
        $("html, body").animate({ "scrollTop": 0 }, 400);
        return false;
      });
      $(window).scroll(function () {
        var top = $(document).scrollTop();
        var g = $("#go-to-top");
        if (top > 300 && g.is(":hidden")) {
          g.fadeIn();
        } else if (top < 300 && g.is(":visible")) {
          g.fadeOut();
        }
      });
    })
  </script>
</head>


<body>

    <div class="header-wrap">
    <div class="header">
        <div class="logo">
            <a href=".././index.html" name="top">
                <img src=".././static/img/logo.png" height="45">
            </a>
        </div>

        <div class="scbox">
            <form role="search" method="get" id="searchform" action="https://github.com/2049bbs/2049bbs.github.io/search" target="_blank">
                <input type="text" maxlength="30" placeholder="站内搜索" name="q" id="q">
            </form>
        </div>

        <div class="c"></div>
    </div>
</div>


    <div class="main-wrap">
        <div class="main">

            <div class="main-content">
                

















<div class="nav-title">
    <div class="float-left fs14">
        <a href=".././index.html">2049BBS</a> » <a href=".././n/3.html">技术</a> (70)
    </div>

    <div class="c"></div>
</div>

<div class="main-box">
    <div class="topic-title">

        <div class="topic-title-main float-left">
            <h1>如何讓chrome支持ESNI</h1>

            <div class="topic-title-date">
                By <a href=".././member/3619.html">立紗Lisa</a>
                at 2020-03-28
            </div>
        </div>

        <div class="detail-avatar">
            <a href=".././member/3619.html">
                <img src="data:image/jpeg;base64,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" alt="立紗Lisa">
            </a>
        </div>

        <div class="c"></div>
    </div>

    <div class="topic-content">
        <p>同學們先<strong>自己去看下火狐的源碼</strong>，理解下火狐的ESNI代碼實現！</p>

<p>我昨天剛下好，<strong>300多MB的壓縮包</strong>！你們慢慢解壓縮吧。。。</p>

<p>代碼太深了，估計很多人不知道ESNI的代碼實現在哪裏。我解釋下，代碼在</p>

<p>security/nss/lib/ssl/tls13esni.c</p>

<p>函數是SSLExp_EnableESNI和tls13_ClientSetupESNI，整個代碼實現其實不難，當然，前提是你和我一樣無聊看完了openssl的代碼</p>

<p>重點講解，我放到https://2049bbs.xyz/t/3750 這裏了</p>


        <p class="mytag float-left">
            
            <a href="https://2049bbs.xyz/tag/ESNI">ESNI</a>, 
            
            <a href="https://2049bbs.xyz/tag/chrome">chrome</a>, 
            
            <a href="https://2049bbs.xyz/tag/支持">支持</a>
            
        </p>

        <div class="c"></div>
        <br>
    </div>
</div>

<div class="nav-title">
    共 3 条回复
</div>

<div class="main-box home-box-list">
    
        <a name="1"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/3619.html">
                    <img src="data:image/jpeg;base64,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" alt="立紗Lisa">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>言歸正傳！</p>

<p>我們講解Chrome了，chrome的TLS實現叫做BoringSSL，fork自著名的openSSL。</p>

<p>開始講如何boringssl的代碼。</p>

<p>翻開課本，boringssl\ssl\handshake_client.cc這個代碼。開始閲讀ssl_client_handshake</p>

<p>對！ESNI是在客戶端發起握手的時候發送的！所以從握手開始讀起。</p>

<p>找到<code class="highlighter-rouge">do_start_connect</code>這個函數！很多人覺得看著這個代碼，很嚇人。別怕，其實關鍵信息就i是<code class="highlighter-rouge">ssl_write_client_hello</code>這麽一行罷了。其他的都不重要~</p>

<p><code class="highlighter-rouge">ssl_write_client_hello</code>這個函數，什麽都不做，純粹拼報文而已！二進制級別拼寫，類似給一個struct賦值。</p>

<p>我們就看<code class="highlighter-rouge">ssl_add_clienthello_tlsext</code>這個函數！因爲ESNI或者SNI都是放在ext字段。</p>

<p>翻開課本 boringssl\ssl\t1_lib.cc 找到 <code class="highlighter-rouge">ssl_add_clienthello_tlsext</code></p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>  for (size_t i = 0; i &lt; kNumExtensions; i++) {
    const size_t len_before = CBB_len(&amp;extensions);
    if (!kExtensions[i].add_clienthello(hs, &amp;extensions)) {
      OPENSSL_PUT_ERROR(SSL, SSL_R_ERROR_ADDING_EXTENSION);
      ERR_add_error_dataf("extension %u", (unsigned)kExtensions[i].value);
      return false;
    }
</code></pre></div></div>

<p>意思是遍歷所有的ext，調用對應ext的add_clienthello函數，拼clienthello報文</p>

<div class="highlighter-rouge"><div class="highlight"><pre class="highlight"><code>// kExtensions contains all the supported extensions.
static const struct tls_extension kExtensions[] = {
  {
    TLSEXT_TYPE_server_name,
    NULL,
    ext_sni_add_clienthello,
    ext_sni_parse_serverhello,
    ext_sni_parse_clienthello,
    ext_sni_add_serverhello,
  },
  {
    TLSEXT_TYPE_extended_master_secret,
    NULL,
    ext_ems_add_clienthello,
    ext_ems_parse_serverhello,
    ext_ems_parse_clienthello,
    ext_ems_add_serverhello,
  },
  {
    TLSEXT_TYPE_renegotiate,
    NULL,
    ext_ri_add_clienthello,
    ext_ri_parse_serverhello,
    ext_ri_parse_clienthello,
    ext_ri_add_serverhello,
  },
  {
    TLSEXT_TYPE_supported_groups,
    NULL,
    ext_supported_groups_add_clienthello,
    ext_supported_groups_parse_serverhello,
    ext_supported_groups_parse_clienthello,
    dont_add_serverhello,
  },
  {
    TLSEXT_TYPE_ec_point_formats,
    NULL,
    ext_ec_point_add_clienthello,
    ext_ec_point_parse_serverhello,
    ext_ec_point_parse_clienthello,
    ext_ec_point_add_serverhello,
  },
  {
    TLSEXT_TYPE_session_ticket,
    NULL,
    ext_ticket_add_clienthello,
    ext_ticket_parse_serverhello,
    // Ticket extension client parsing is handled in ssl_session.c
    ignore_parse_clienthello,
    ext_ticket_add_serverhello,
  },
  {
    TLSEXT_TYPE_application_layer_protocol_negotiation,
    NULL,
    ext_alpn_add_clienthello,
    ext_alpn_parse_serverhello,
    // ALPN is negotiated late in |ssl_negotiate_alpn|.
    ignore_parse_clienthello,
    ext_alpn_add_serverhello,
  },
  {
    TLSEXT_TYPE_status_request,
    NULL,
    ext_ocsp_add_clienthello,
    ext_ocsp_parse_serverhello,
    ext_ocsp_parse_clienthello,
    ext_ocsp_add_serverhello,
  },
  {
    TLSEXT_TYPE_signature_algorithms,
    NULL,
    ext_sigalgs_add_clienthello,
    forbid_parse_serverhello,
    ext_sigalgs_parse_clienthello,
    dont_add_serverhello,
  },
  {
    TLSEXT_TYPE_next_proto_neg,
    NULL,
    ext_npn_add_clienthello,
    ext_npn_parse_serverhello,
    ext_npn_parse_clienthello,
    ext_npn_add_serverhello,
  },
  {
    TLSEXT_TYPE_certificate_timestamp,
    NULL,
    ext_sct_add_clienthello,
    ext_sct_parse_serverhello,
    ext_sct_parse_clienthello,
    ext_sct_add_serverhello,
  },
  {
    TLSEXT_TYPE_channel_id,
    ext_channel_id_init,
    ext_channel_id_add_clienthello,
    ext_channel_id_parse_serverhello,
    ext_channel_id_parse_clienthello,
    ext_channel_id_add_serverhello,
  },
  {
    TLSEXT_TYPE_srtp,
    ext_srtp_init,
    ext_srtp_add_clienthello,
    ext_srtp_parse_serverhello,
    ext_srtp_parse_clienthello,
    ext_srtp_add_serverhello,
  },
  {
    TLSEXT_TYPE_key_share,
    NULL,
    ext_key_share_add_clienthello,
    forbid_parse_serverhello,
    ignore_parse_clienthello,
    dont_add_serverhello,
  },
  {
    TLSEXT_TYPE_psk_key_exchange_modes,
    NULL,
    ext_psk_key_exchange_modes_add_clienthello,
    forbid_parse_serverhello,
    ext_psk_key_exchange_modes_parse_clienthello,
    dont_add_serverhello,
  },
  {
    TLSEXT_TYPE_early_data,
    NULL,
    ext_early_data_add_clienthello,
    ext_early_data_parse_serverhello,
    ext_early_data_parse_clienthello,
    ext_early_data_add_serverhello,
  },
  {
    TLSEXT_TYPE_supported_versions,
    NULL,
    ext_supported_versions_add_clienthello,
    forbid_parse_serverhello,
    ignore_parse_clienthello,
    dont_add_serverhello,
  },
  {
    TLSEXT_TYPE_cookie,
    NULL,
    ext_cookie_add_clienthello,
    forbid_parse_serverhello,
    ignore_parse_clienthello,
    dont_add_serverhello,
  },
  {
    TLSEXT_TYPE_quic_transport_parameters,
    NULL,
    ext_quic_transport_params_add_clienthello,
    ext_quic_transport_params_parse_serverhello,
    ext_quic_transport_params_parse_clienthello,
    ext_quic_transport_params_add_serverhello,
  },
  {
    TLSEXT_TYPE_token_binding,
    NULL,
    ext_token_binding_add_clienthello,
    ext_token_binding_parse_serverhello,
    ext_token_binding_parse_clienthello,
    ext_token_binding_add_serverhello,
  },
  {
    TLSEXT_TYPE_cert_compression,
    NULL,
    cert_compression_add_clienthello,
    cert_compression_parse_serverhello,
    cert_compression_parse_clienthello,
    cert_compression_add_serverhello,
  },
  {
    TLSEXT_TYPE_delegated_credential,
    NULL,
    ext_delegated_credential_add_clienthello,
    forbid_parse_serverhello,
    ext_delegated_credential_parse_clienthello,
    dont_add_serverhello,
  },
};
</code></pre></div></div>

<p>因爲我們要做的是SNI，所以看到了第一個ext，找到了它對應的add_clienthello是ext_sni_add_clienthello</p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/3619.html">立紗Lisa</a>
                        at 2020-03-28
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">1</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
        <a name="2"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/3619.html">
                    <img src="data:image/jpeg;base64,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" alt="立紗Lisa">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>繼續查看ext_sni_add_clienthello函數</p>

<p>發現CBB_add_bytes(&amp;name, (const uint8_t *)ssl-&gt;hostname.get(),這行代碼，會對SNI賦值hostname</p>

<p>也就是說，爲什麽我們通過wireshark抓包，可以<strong>明文看到自己訪問什麽網站</strong>，就是這行代碼造成的！</p>

<p>GFW通過全網檢查ClientHello的SNI字段，來<strong>判斷你在訪問什麽網站</strong>！而且因爲是<strong>明文</strong>，所以GFW的工作很簡單，只要檢查你的TLS握手SNI字段，如果是敏感詞，就RST掉你的tcp連接。你就上不去了。品蔥就是這樣，所以上不去，需要開啓ESNI功能，就沒事了~</p>

<p>代碼修改：</p>

<p>1.增加一個ext，取名叫ESNI，參考SNI的實現，完成相關代碼</p>

<p>2.移植火狐的esni加密代碼到boringssl，完成第一步的esni報文拼接</p>

<p>3.編譯自己的boringssl庫，替換掉chrome自帶的boringssl</p>

<p>4.chrome有自己dll校驗機制，你手動替換有點問題，好像跑不起來，得網上找下教程，學習如何替換chrome的boringssl</p>

<p>別找我要代碼或者已經編譯好的dll ！我要是寫好了，早提PR給chrome了~</p>

<p>關於<strong>爲什麽</strong>不自己寫代碼完成剛才我説的這麽多事情：</p>

<p>我翻墻的條件<strong>很糟糕</strong>，下載chrome的源碼，經常斷掉！失敗就得重新下載。至今沒有下載到chrome源碼。</p>

<p>另外編譯環境配置<strong>非常複雜</strong>，我沒有那個功夫去完成這麽<strong>費時間的工作</strong><del>。老了啊，想當年自己花了3個星期，搭了Gentoo Linux，現在搭個chrome的編譯環境都覺得浪費時間</del></p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/3619.html">立紗Lisa</a>
                        at 2020-03-28
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">2</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
        <a name="3"></a>

        

        <div class="commont-item">
            <div class="commont-avatar">
                <a href=".././member/3615.html">
                    <img src="data:image/jpeg;base64,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" alt="张怀义">
                </a>
            </div>

            <div class="commont-data">

                <div class="commont-content">
                    <p>大神你好，我一上来，就看你更新了好多文章啊！大神学习这些有什么方式方法么，我想当一个程序员！</p>

                </div>

                <div class="commont-data-date">
                    <div class="float-left">
                        <a href=".././member/3615.html">张怀义</a>
                        at 2020-03-28
                    </div>

                    <div class="float-right">
                        <span class="commonet-count">3</span>
                    </div>

                    <div class="c"></div>
                </div>

                <div class="c"></div>
            </div>

            <div class="c"></div>
        </div>
    
</div>

            </div>
            
            <div class="main-sider">

    <div class="sider-box">

        <div class="sider-box-title">关于</div>

        <div class="sider-box-content">
            <p>2049BBS 的自动更新镜像站，免翻墙访问。</p>
            <div class="btn">
                <a href="https://github.com/2049bbs/2049bbs.github.io">Github Repo</a>
                <a href="https://github.com/2049bbs/2049bbs.github.io/archive/gh-pages.zip">离线浏览</a>
                <a href="https://2049bbs.github.io/feed.xml">RSS订阅</a>
                <a href=".././t/1860.html">节点订阅功能帮助</a>
                
            </div>
            <div class="c"></div>
        </div>

    </div>

    <div class="sider-box">

        <div class="sider-box-title">源站地址（已被墙）</div>

        <div class="sider-box-content">
            <p><a href="https://2049bbs.xyz/t/3775">https://2049bbs.xyz/t/3775</a></p>
            <div class="c"></div>
        </div>

    </div>

    <div class="sider-box">

        <div class="sider-box-title">节点</div>

        <div class="sider-box-content">
            <div class="btn">
                
                <a href=".././n/1.html">问答</a>
                
                <a href=".././n/10.html">人物</a>
                
                <a href=".././n/11.html">影视</a>
                
                <a href=".././n/12.html">分享创造</a>
                
                <a href=".././n/13.html">站务</a>
                
                <a href=".././n/14.html">使用指南</a>
                
                <a href=".././n/15.html">Geek</a>
                
                <a href=".././n/16.html">2049</a>
                
                <a href=".././n/17.html">外段</a>
                
                <a href=".././n/18.html">梯子</a>
                
                <a href=".././n/19.html">树洞</a>
                
                <a href=".././n/2.html">时政</a>
                
                <a href=".././n/3.html">技术</a>
                
                <a href=".././n/4.html">水</a>
                
                <a href=".././n/5.html">分享发现</a>
                
                <a href=".././n/6.html">读书</a>
                
                <a href=".././n/7.html">音乐</a>
                
                <a href=".././n/8.html">博客</a>
                
                <a href=".././n/9.html">吐槽</a>
                
            </div>
            <div class="c"></div>
        </div>

    </div>
</div>


            <div class="c"></div>

        </div>
        <div class="c"></div>
    </div>

    <div class="footer-wrap">

    <div class="footer">
        <p>
            © Copyright <a href=".././index.html">2049BBS</a> •
            <a rel="nofollow" href=".././feed.xml">Atom Feed</a>
        </p>

        <p>
            Powered by <a href="https://jekyllrb.com/" target="_blank">Jekyll</a>
            and <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
        </p>

        <p>
            <a href="https://github.com/2049bbs/2049bbs.github.io/" target="_blank">镜像站计划项目主页</a>
        </p>
    </div>

    <a style="display: none;" rel="nofollow" href="#top" id="go-to-top">▲</a>

</div>


</body>

</html>
